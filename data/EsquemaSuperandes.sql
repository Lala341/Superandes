--- Sentencias SQL para la creacion del esquema de parranderos
--- Las tablas tienen prefijo A_ para facilitar su acceso desde SQL Developer

-- USO
-- Copie el contenido de este archivo en una pestana SQL de SQL Developer
-- Ejecutelo como un script - Utilice el boton correspondiente de la pestana utilizada

-- Creacion del secuenciador
create sequence superandes_sequence;

CREATE TABLE SUPERANDES
   (ID NUMBER, 
    CANTIDAD_RECOMPRA NUMBER, 
	NOMBRE VARCHAR2(255 BYTE), 
	CONSTRAINT SUPERANDES_PK PRIMARY KEY (ID));
	


CREATE TABLE CIUDAD 
   (ID NUMBER, 
	NOMBRE VARCHAR2(255 BYTE) NOT NULL, 
	DIRECCION VARCHAR2(255 BYTE),
	CONSTRAINT CIUDAD_PK PRIMARY KEY (ID));



CREATE TABLE SUCURSAL
   (ID NUMBER, 
	TAMANHO NUMBER NOT NULL, 
	TIPO_MERCADO VARCHAR2(255 BYTE) NOT NULL, 
	VENTAS_TOTALES NUMBER NOT NULL, 
	CIUDAD NUMBER NOT NULL, 
	CONSTRAINT SUCURSAL_PK PRIMARY KEY (ID));
	 
ALTER TABLE SUCURSAL
ADD CONSTRAINT fk_ciudad
    FOREIGN KEY (ciudad)
    REFERENCES CIUDAD(id)
ENABLE;



CREATE TABLE BODEGA
   (ID NUMBER, 
	CANTIDAD_PRODUCTOS NUMBER NOT NULL, 
	CAPACIDAD_TOTAL NUMBER NOT NULL, 
	TIPO_PRODUCTO VARCHAR2(255 BYTE) NOT NULL, 
    PESO NUMBER NOT NULL, 
	VOLUMEN NUMBER NOT NULL, 
	NIVEL_REORDEN NUMBER, 
	SUCURSAL NUMBER NOT NULL, 

	CONSTRAINT A_BEBEDOR_PK PRIMARY KEY (ID));

ALTER TABLE BODEGA
	ADD CONSTRAINT CK_BODEGA_TIPO_PRODUCTO 
        CHECK (TIPO_PRODUCTO IN ('ASEO', 'ABARROTES', 'PRENDASDEVESTIR', 'MUEBLES', 'HERRAMIENTAS', 'ELECTRODOMESTICOS', 'CONGELADOS'))
ENABLE;

ALTER TABLE BODEGA
	ADD CONSTRAINT FK_BODEGA_SUCURSAL
        FOREIGN KEY (SUCURSAL)
        REFERENCES SUCURSAL(id)
ENABLE;



CREATE TABLE ESTANTE
   (ID NUMBER, 
	CANTIDAD_PRODUCTOS NUMBER NOT NULL, 
	CAPACIDAD_TOTAL NUMBER NOT NULL, 
	TIPO_PRODUCTO VARCHAR2(255 BYTE) NOT NULL, 
    PESO NUMBER NOT NULL, 
	VOLUMEN NUMBER NOT NULL, 
	NIVEL_REORDEN NUMBER, 
    NIVEL_ABASTECIMIENTO NUMBER NOT NULL, 
	SUCURSAL NUMBER NOT NULL, 

	CONSTRAINT A_BEBEDOR_PK PRIMARY KEY (ID));

ALTER TABLE BODEGA
	ADD CONSTRAINT CK_BODEGA_TIPO_PRODUCTO 
        CHECK (TIPO_PRODUCTO IN ('ASEO', 'ABARROTES', 'PRENDASDEVESTIR', 'MUEBLES', 'HERRAMIENTAS', 'ELECTRODOMESTICOS', 'CONGELADOS'))
ENABLE;

ALTER TABLE BODEGA
	ADD CONSTRAINT FK_BODEGA_SUCURSAL
        FOREIGN KEY (SUCURSAL)
        REFERENCES SUCURSAL(id)
ENABLE;



CREATE TABLE CATEGORIA
   (ID NUMBER, 
	NOMBRE VARCHAR2(255 BYTE) NOT NULL, 
    TIPO_ALMACENAMIENTO VARCHAR2(255 BYTE) NOT NULL, 
	TIPO_MANEJO VARCHAR2(255 BYTE) NOT NULL, 
	
	CONSTRAINT CATEGORIA_PK PRIMARY KEY (ID));

ALTER TABLE CATEGORIA
	ADD CONSTRAINT CK_CATEGORIA_NOMBRE 
        CHECK (NOMBRE IN ('PERECEDERO', 'NOPERECEDERO'))
ENABLE;



CREATE TABLE PERECEDERO
(
  ID NUMBER,
  CATEGORIA NUMBER NOT NULL,
  FECHA_VENCIMIENTO VARCHAR2(255 BYTE) NOT NULL,
  TIPO_CATEGORIA_PERCEDERO VARCHAR2(255 BYTE) NOT NULL,
  CONSTRAINT PERECEDERO_PK PRIMARY KEY (ID));

ALTER TABLE PERECEDERO
ADD CONSTRAINT FK_PERECEDERO_CATEGORIA
    FOREIGN KEY (CATEGORIA)
    REFERENCES CATEGORIA(id)
ENABLE;
    


CREATE TABLE NOPERECEDERO
(
  ID NUMBER,
  CATEGORIA NUMBER NOT NULL,
  TIPO_CATEGORIA_NO_PERCEDERO VARCHAR2(255 BYTE) NOT NULL,
  CONSTRAINT NOPERECEDERO_PK PRIMARY KEY (ID));

ALTER TABLE NOPERECEDERO
ADD CONSTRAINT FK_NOPERECEDERO_CATEGORIA
    FOREIGN KEY (CATEGORIA)
    REFERENCES CATEGORIA(id)
ENABLE;
    


CREATE TABLE PRODUCTO 
(
  ID NUMBER,
  NOMBRE NUMBER NOT NULL,
  CANTIDAD NUMBER NOT NULL, 
  CODIGO_BARRAS VARCHAR2(255 BYTE) NOT NULL,
  ESPECIFICACIONES_EMPAQUETADO VARCHAR2(255 BYTE),
  ESTADO VARCHAR2(255 BYTE) NOT NULL,
  MARCA VARCHAR2(255 BYTE) NOT NULL,
  UNIDAD_POR_UNIDAD_MEDIDA NUMBER NOT NULL,
  PRECIO_UNITARIO NUMBER NOT NULL,
  PRESENTACION VARCHAR2(255 BYTE),
  UNIDAD_MEDIDA NUMBER NOT NULL,
  CATEGORIA NUMBER NOT NULL,
  CONSTRAINT PRODUCTO_PK PRIMARY KEY (ID));

ALTER TABLE PRODUCTO
ADD CONSTRAINT FK_PERECEDERO_CATEGORIA
    FOREIGN KEY (CATEGORIA)
    REFERENCES CATEGORIA(id)
ENABLE;
    


CREATE TABLE PRODUCTOESTANTE
(
  ESTANTE NUMBER,
  PRODUCTO NUMBER,
  CONSTRAINT PRODUCTOESTANTE_PK PRIMARY KEY (ESTANTE, PRODUCTO));

ALTER TABLE PRODUCTOESTANTE
ADD CONSTRAINT FK_PRODUCTOESTANTE_ESTANTE
    FOREIGN KEY (ESTANTE)
    REFERENCES ESTANTE(id)
ENABLE;
    
ALTER TABLE PRODUCTOESTANTE
ADD CONSTRAINT FK_PRODUCTOESTANTE_PRODUCTO
    FOREIGN KEY (PRODUCTO)
    REFERENCES PRODUCTO(id)
ENABLE;


CREATE TABLE PRODUCTOBODEGA
(
  BODEGA NUMBER,
  PRODUCTO NUMBER,
  CONSTRAINT PRODUCTOESTANTE_PK PRIMARY KEY (BODEGA, PRODUCTO));

ALTER TABLE PRODUCTOBODEGA
ADD CONSTRAINT FK_PRODUCTOBODEGA_BODEGA
    FOREIGN KEY (BODEGA)
    REFERENCES BODEGA(id)
ENABLE;
    
ALTER TABLE PRODUCTOBODEGA
ADD CONSTRAINT FK_PRODUCTOBODEGA_PRODUCTO
    FOREIGN KEY (PRODUCTO)
    REFERENCES PRODUCTO(id)
ENABLE;




CREATE TABLE PERSONANATURAL
(
  ID_CONSUMIDOR NUMBER,
  DOCUMENTO_IDENTIDAD NUMBER,
  CONSTRAINT PERSONANATURAL_PK PRIMARY KEY (ID_CONSUMIDOR, DOCUMENTO_IDENTIDAD));

ALTER TABLE PERSONANATURAL
ADD CONSTRAINT FK_PERSONANATURAL_ID_CONSUMIDOR
    FOREIGN KEY (ID_CONSUMIDOR)
    REFERENCES CONSUMIDOR(id)
ENABLE;
    


CREATE TABLE EMPRESA
(
  ID_CONSUMIDOR NUMBER,
  NIT NUMBER,
  DIRECCION VARCHAR2(255 BYTE) NOT NULL,
  CONSTRAINT EMPRESA_PK PRIMARY KEY (ID_CONSUMIDOR, NIT));

ALTER TABLE EMPRESA
ADD CONSTRAINT FK_EMPRESA_ID_CONSUMIDOR
    FOREIGN KEY (ID_CONSUMIDOR)
    REFERENCES CONSUMIDOR(id)
ENABLE;
    


CREATE TABLE CONSUMIDOR
(
  ID NUMBER,
  NOMBRE VARCHAR2(255 BYTE) NOT NULL,
  CORREO_ELECTRICO VARCHAR2(255 BYTE) NOT NULL,
  TIPO_CONSUMIDOR VARCHAR2(255 BYTE) NOT NULL,
  CONSTRAINT CONSUMIDOR_PK PRIMARY KEY (ID));

ALTER TABLE CONSUMIDOR
    ADD CONSTRAINT CK_CONSUMIDOR_TIPO_CONSUMIDOR
    CHECK (TIPO_CONSUMIDOR IN ('PNATURAL', 'EMPRESA'))
ENABLE;





CREATE TABLE FIDELIZACION
(
  ID_CONSUMIDOR NUMBER,
  CANTIDAD_PUNTOS NUMBER NOT NULL,
  CONSTRAINT FIDELIZACION_PK PRIMARY KEY (ID_CONSUMIDOR));

ALTER TABLE FIDELIZACION
ADD CONSTRAINT FK_FIDELIZACION_ID_CONSUMIDOR
    FOREIGN KEY (ID_CONSUMIDOR)
    REFERENCES CONSUMIDOR(id)
ENABLE;



CREATE TABLE PRODUCTOTRANSACCION
(
  ID_PRODUCTO NUMBER,
  CANTIDAD_VENTA NUMBER NOT NULL,
  CONSTRAINT PRODUCTOTRANSACCION_PK PRIMARY KEY (ID_PRODUCTO));

ALTER TABLE PRODUCTOTRANSACCION
ADD CONSTRAINT FK_PRODUCTOTRANSACCION_ID_PRODUCTO
    FOREIGN KEY (ID_PRODUCTO)
    REFERENCES PRODUCTO(id)
ENABLE;




CREATE TABLE VENTA
(
  ID NUMBER,
  FECHA VARCHAR2(255 BYTE) NOT NULL,
  FORMA_PAGO VARCHAR2(255 BYTE) NOT NULL,
  VALOR_TOTAL NUMBER NOT NULL,
  FACTURA NUMBER,
  CONSUMIDOR NUMBER NOT NULL,
  CONSTRAINT VENTA_PK PRIMARY KEY (ID));

ALTER TABLE VENTA
ADD CONSTRAINT FK_VENTA_CONSUMIDOR
    FOREIGN KEY (CONSUMIDOR)
    REFERENCES CONSUMIDOR(id)
ENABLE;

ALTER TABLE VENTA
ADD CONSTRAINT FK_VENTA_FACTURA
    FOREIGN KEY (FACTURA)
    REFERENCES FACTURA(id)
ENABLE;




CREATE TABLE FACTURA
(
  ID NUMBER,
  CONSTRAINT FACTURA_PK PRIMARY KEY (ID));




CREATE TABLE CARRITOCOMPRAS
(
  ID NUMBER,
  ESTADO VARCHAR2(255 BYTE) NOT NULL,
  CONSUMIDOR NUMBER NOT NULL,
  CONSTRAINT CARRITOCOMPRAS_PK PRIMARY KEY (ID));

ALTER TABLE CARRITOCOMPRAS
ADD CONSTRAINT FK_CARRITOCOMPRAS_CONSUMIDOR
    FOREIGN KEY (CONSUMIDOR)
    REFERENCES CONSUMIDOR(id)
ENABLE;





CREATE TABLE PRODUCTOVENTA
(
  VENTA NUMBER,
  PRODUCTO NUMBER,
  CANTIDAD_PRODUCTO NUMBER NOT NULL,
  UNIDAD_MEDIDA VARCHAR2(255 BYTE) NOT NULL,
  CONSTRAINT PRODUCTOVENTA_PK PRIMARY KEY (VENTA,PRODUCTO));

ALTER TABLE PRODUCTOVENTA
ADD CONSTRAINT FK_PRODUCTOVENTA_VENTA
    FOREIGN KEY (VENTA)
    REFERENCES VENTA(id)
ENABLE;

ALTER TABLE PRODUCTOVENTA
ADD CONSTRAINT FK_PRODUCTOVENTA_PRODUCTO
    FOREIGN KEY (PRODUCTO)
    REFERENCES PRODUCTO(id)
ENABLE;



CREATE TABLE PRODUCTOCARRITOCOMPRAS
(
  CARRITOCOMPRAS NUMBER,
  PRODUCTO NUMBER,
  CANTIDAD_PRODUCTO NUMBER NOT NULL,
  UNIDAD_MEDIDA VARCHAR2(255 BYTE) NOT NULL,
  CONSTRAINT PRODUCTOCARRITOCOMPRAS_PK PRIMARY KEY (CARRITOCOMPRAS,PRODUCTO));

ALTER TABLE PRODUCTOCARRITOCOMPRAS
ADD CONSTRAINT FK_PRODUCTOCARRITOCOMPRAS_CARRITOCOMPRAS
    FOREIGN KEY (CARRITOCOMPRAS)
    REFERENCES CARRITOCOMPRAS(id)
ENABLE;

ALTER TABLE PRODUCTOCARRITOCOMPRAS
ADD CONSTRAINT FK_PRODUCTOCARRITOCOMPRAS_PRODUCTO
    FOREIGN KEY (PRODUCTO)
    REFERENCES PRODUCTO(id)
ENABLE;




CREATE TABLE PROMOCION
(
  NOMBRE NUMBER,
  FECHA_INICIO VARCHAR2(255 BYTE) NOT NULL,
  FECHA_FINALIZACION VARCHAR2(255 BYTE) NOT NULL,
  CONSTRAINT PROMOCION_PK PRIMARY KEY (NOMBRE));




CREATE TABLE PROMOCIONSUCURSAL
   (PROMOCION NUMBER, 
	SUCURSAL NUMBER, 

	CONSTRAINT PROMOCIONSUCURSAL_PK PRIMARY KEY (PROMOCION));


ALTER TABLE PROMOCIONSUCURSAL
	ADD CONSTRAINT FK_PROMOCIONSUCURSAL_SUCURSAL
        FOREIGN KEY (SUCURSAL)
        REFERENCES SUCURSAL(id)
ENABLE;




CREATE TABLE PROVEEDORES
   (NIT NUMBER, 
	NOMBRE NUMBER, 

	CONSTRAINT PROVEEDORES_PK PRIMARY KEY (NIT));





CREATE TABLE PRODUCTOOFRECIDO
   (ID NUMBER, 
	PRECIO_PROVEEDOR NUMBER NOT NULL,
    CALIFICACION_TOTAL NUMBER,
    CALIDAD VARCHAR2(255 BYTE) NOT NULL,
    CUMPLIMIENTO VARCHAR2(255 BYTE) NOT NULL,
    PRODUCTO_ID NUMBER NOT NULL,

	CONSTRAINT PRODUCTOOFRECIDO_PK PRIMARY KEY (ID));


ALTER TABLE PRODUCTOOFRECIDO
	ADD CONSTRAINT FK_PRODUCTOOFRECIDO_PRODUCTO_ID
        FOREIGN KEY (PRODUCTO_ID)
        REFERENCES PRODUCTO(id)
ENABLE;




CREATE TABLE ORDENPEDIDO
   (ID NUMBER, 
    ESTADO VARCHAR2(255 BYTE) NOT NULL,
    CALIFICACION NUMBER NOT NULL,
    FECHA VARCHAR2(255 BYTE) NOT NULL,
    FECHA_ENTREGA VARCHAR2(255 BYTE) NOT NULL,
    PROVEEDOR NUMBER NOT NULL,
    PRODUCTO_OFRECIDO NUMBER NOT NULL,
    CANTIDAD_PRODUCTO NUMBER NOT NULL,
    UNIDAD_MEDIDA VARCHAR2(255 BYTE) NOT NULL,
    SUCURSAL NUMBER NOT NULL,
    CONSTRAINT ORDENPEDIDO_PK PRIMARY KEY (ID));


ALTER TABLE ORDENPEDIDO
	ADD CONSTRAINT FK_ORDENPEDIDO_PROVEEDOR
        FOREIGN KEY (PROVEEDOR)
        REFERENCES PROVEEDOR(id)
ENABLE;
ALTER TABLE ORDENPEDIDO
	ADD CONSTRAINT FK_ORDENPEDIDO_SUCURSAL
        FOREIGN KEY (SUCURSAL)
        REFERENCES SUCURSAL(id)
ENABLE;
ALTER TABLE ORDENPEDIDO
	ADD CONSTRAINT FK_ORDENPEDIDO_PRODUCTO_OFRECIDO
        FOREIGN KEY (PRODUCTO_OFRECIDO)
        REFERENCES PRODUCTOOFRECIDO(id)
ENABLE;

COMMIT;
